{"version":3,"file":"processEntrypoint.js","names":["isAborted","processEntrypoint","only","log","entrypoint","_usingCtx","_usingCtx2","abortSignal","u","createAbortSignal","undefined","result","getNext","assertNotSuperseded","setTransformResult","_","e","d","supersededWith"],"sources":["../../../src/transform/generators/processEntrypoint.ts"],"sourcesContent":["import { isAborted } from '../actions/AbortError';\nimport type { IProcessEntrypointAction, SyncScenarioForAction } from '../types';\n\n/**\n * The first stage of processing an entrypoint.\n * This stage is responsible for:\n * - scheduling the explodeReexports action\n * - scheduling the transform action\n * - rescheduling itself if the entrypoint is superseded\n */\nexport function* processEntrypoint(\n  this: IProcessEntrypointAction\n): SyncScenarioForAction<IProcessEntrypointAction> {\n  const { only, log } = this.entrypoint;\n  log('start processing (only: %o)', only);\n\n  try {\n    using abortSignal = this.createAbortSignal();\n\n    yield ['explodeReexports', this.entrypoint, undefined, abortSignal];\n    const result = yield* this.getNext(\n      'transform',\n      this.entrypoint,\n      undefined,\n      abortSignal\n    );\n\n    this.entrypoint.assertNotSuperseded();\n\n    this.entrypoint.setTransformResult(result);\n\n    log('entrypoint processing finished');\n  } catch (e) {\n    if (isAborted(e) && this.entrypoint.supersededWith) {\n      log('processing aborted, schedule the next attempt');\n      yield* this.getNext(\n        'processEntrypoint',\n        this.entrypoint.supersededWith,\n        undefined,\n        null\n      );\n\n      return;\n    }\n\n    log(`Unhandled error: %O`, e);\n    throw e;\n  }\n}\n"],"mappings":";AAAA,SAASA,SAAS,QAAQ,uBAAuB;AAGjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,UAAUC,iBAAiBA,CAAA,EAEiB;EACjD,MAAM;IAAEC,IAAI;IAAEC;EAAI,CAAC,GAAG,IAAI,CAACC,UAAU;EACrCD,GAAG,CAAC,6BAA6B,EAAED,IAAI,CAAC;EAExC;IAAI;MAAA,IAAAG,SAAA,GAAAC,UAAA;MACF,MAAMC,WAAW,GAAAF,SAAA,CAAAG,CAAA,CAAG,IAAI,CAACC,iBAAiB,CAAC,CAAC;MAE5C,MAAM,CAAC,kBAAkB,EAAE,IAAI,CAACL,UAAU,EAAEM,SAAS,EAAEH,WAAW,CAAC;MACnE,MAAMI,MAAM,GAAG,OAAO,IAAI,CAACC,OAAO,CAChC,WAAW,EACX,IAAI,CAACR,UAAU,EACfM,SAAS,EACTH,WACF,CAAC;MAED,IAAI,CAACH,UAAU,CAACS,mBAAmB,CAAC,CAAC;MAErC,IAAI,CAACT,UAAU,CAACU,kBAAkB,CAACH,MAAM,CAAC;MAE1CR,GAAG,CAAC,gCAAgC,CAAC;IAAC,SAAAY,CAAA;MAAAV,SAAA,CAAAW,CAAA,GAAAD,CAAA;IAAA;MAAAV,SAAA,CAAAY,CAAA;IAAA;EACvC,EAAC,OAAOD,CAAC,EAAE;IACV,IAAIhB,SAAS,CAACgB,CAAC,CAAC,IAAI,IAAI,CAACZ,UAAU,CAACc,cAAc,EAAE;MAClDf,GAAG,CAAC,+CAA+C,CAAC;MACpD,OAAO,IAAI,CAACS,OAAO,CACjB,mBAAmB,EACnB,IAAI,CAACR,UAAU,CAACc,cAAc,EAC9BR,SAAS,EACT,IACF,CAAC;MAED;IACF;IAEAP,GAAG,CAAE,qBAAoB,EAAEa,CAAC,CAAC;IAC7B,MAAMA,CAAC;EACT;AACF","ignoreList":[]}