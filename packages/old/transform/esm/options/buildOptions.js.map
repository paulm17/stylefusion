{"version":3,"file":"buildOptions.js","names":["babelMerge","isNotNull","cache","WeakMap","merge","a","b","console","log","has","set","cacheForA","get","result","buildOptions","configs","map","i","filter","reduce"],"sources":["../../src/options/buildOptions.ts"],"sourcesContent":["// eslint-disable-next-line @typescript-eslint/triple-slash-reference\n/// <reference path=\"./babel-merge.d.ts\" />\n\nimport type { TransformOptions } from '@babel/core';\nimport babelMerge from 'babel-merge';\n\nimport { isNotNull } from '../utils/isNotNull';\n\nconst cache = new WeakMap<\n  TransformOptions,\n  WeakMap<TransformOptions, TransformOptions>\n>();\n\nconst merge = (a: TransformOptions, b: TransformOptions) => {\n  console.log(\"buildOptions - merge\");\n  if (!cache.has(a)) {\n    cache.set(a, new WeakMap());\n  }\n\n  const cacheForA = cache.get(a)!;\n  if (cacheForA.has(b)) {\n    return cacheForA.get(b)!;\n  }\n\n  const result = babelMerge(a, b);\n  cacheForA.set(b, result);\n  return result;\n};\n\n/**\n * Merges babel configs together. If a pair of configs were merged before,\n * it will return the cached result.\n */\nexport function buildOptions(\n  ...configs: (TransformOptions | null | undefined)[]\n): TransformOptions {\n  console.log(\"buildOptions - buildOptions\");\n  // Merge all configs together\n  return configs\n    .map((i) => i ?? null)\n    .filter(isNotNull)\n    .reduce(merge);\n}\n"],"mappings":"AAAA;AACA;;AAGA,OAAOA,UAAU,MAAM,aAAa;AAEpC,SAASC,SAAS,QAAQ,oBAAoB;AAE9C,MAAMC,KAAK,GAAG,IAAIC,OAAO,CAGvB,CAAC;AAEH,MAAMC,KAAK,GAAGA,CAACC,CAAmB,EAAEC,CAAmB,KAAK;EAC1DC,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;EACnC,IAAI,CAACN,KAAK,CAACO,GAAG,CAACJ,CAAC,CAAC,EAAE;IACjBH,KAAK,CAACQ,GAAG,CAACL,CAAC,EAAE,IAAIF,OAAO,CAAC,CAAC,CAAC;EAC7B;EAEA,MAAMQ,SAAS,GAAGT,KAAK,CAACU,GAAG,CAACP,CAAC,CAAE;EAC/B,IAAIM,SAAS,CAACF,GAAG,CAACH,CAAC,CAAC,EAAE;IACpB,OAAOK,SAAS,CAACC,GAAG,CAACN,CAAC,CAAC;EACzB;EAEA,MAAMO,MAAM,GAAGb,UAAU,CAACK,CAAC,EAAEC,CAAC,CAAC;EAC/BK,SAAS,CAACD,GAAG,CAACJ,CAAC,EAAEO,MAAM,CAAC;EACxB,OAAOA,MAAM;AACf,CAAC;;AAED;AACA;AACA;AACA;AACA,OAAO,SAASC,YAAYA,CAC1B,GAAGC,OAAgD,EACjC;EAClBR,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC;EAC1C;EACA,OAAOO,OAAO,CACXC,GAAG,CAAEC,CAAC,IAAKA,CAAC,IAAI,IAAI,CAAC,CACrBC,MAAM,CAACjB,SAAS,CAAC,CACjBkB,MAAM,CAACf,KAAK,CAAC;AAClB","ignoreList":[]}